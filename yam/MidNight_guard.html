<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸ§¸ Find the Children</title>
  <style>
    body {
      background: black;
      color: lime;
      font-family: 'Courier New', monospace;
      text-align: center;
      margin: 0;
    }
    canvas {
      display: block;
      margin: 20px auto;
      border: 4px solid lime;
      background: #111;
    }
    #msg {
      font-size: 18px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>ðŸ§¸ Find the Children</h1>
  <canvas id="game" width="320" height="320"></canvas>
  <div id="msg">Use arrow keys to move | Level 1</div>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const tileSize = 32;

    let currentLevel = 0;
    let levels = [
      [
        "P.........",
        "..........",
        "..C.......",
        "..........",
        "..........",
        "..........",
        ".....C....",
        "..........",
        "..........",
        ".........E"
      ],
      [
        "P....#....",
        "..#.......",
        "..C....#..",
        "......#...",
        "...#......",
        "......#...",
        ".....C....",
        "...#......",
        "......#...",
        ".........E"
      ],
      [
        "P...#.....",
        "....#..C..",
        "....#.....",
        "....###...",
        "...#......",
        "......#...",
        "...#..C...",
        "..#.......",
        "......#...",
        ".........E"
      ]
      // Add more levels up to 12...
    ];

    let map = [];
    let player = { x: 0, y: 0 };
    let children = [];
    let exit = { x: 0, y: 0 };

    function loadLevel(n) {
      map = levels[n];
      children = [];
      for (let y = 0; y < map.length; y++) {
        for (let x = 0; x < map[y].length; x++) {
          let tile = map[y][x];
          if (tile === 'P') {
            player.x = x;
            player.y = y;
          } else if (tile === 'C') {
            children.push({ x, y, collected: false });
          } else if (tile === 'E') {
            exit.x = x;
            exit.y = y;
          }
        }
      }
      draw();
      updateMsg();
    }

    function draw() {
      ctx.fillStyle = '#111';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      for (let y = 0; y < map.length; y++) {
        for (let x = 0; x < map[y].length; x++) {
          if (map[y][x] === '#') {
            ctx.fillStyle = 'gray';
            ctx.fillRect(x * tileSize, y * tileSize, tileSize, tileSize);
          }
        }
      }

      ctx.fillStyle = 'red';
      ctx.fillRect(player.x * tileSize, player.y * tileSize, tileSize, tileSize);

      ctx.fillStyle = 'yellow';
      children.forEach(c => {
        if (!c.collected) {
          ctx.fillRect(c.x * tileSize + 8, c.y * tileSize + 8, 16, 16);
        }
      });

      ctx.fillStyle = 'lime';
      ctx.fillRect(exit.x * tileSize, exit.y * tileSize, tileSize, tileSize);
    }

    function updateMsg() {
      let collected = children.filter(c => c.collected).length;
      let msg = `Use arrow keys to move | Level ${currentLevel + 1} | Collected: ${collected}/${children.length}`;
      if (collected === children.length && player.x === exit.x && player.y === exit.y) {
        msg = `âœ… Level ${currentLevel + 1} complete! Press Enter to continue...`;
      }
      document.getElementById('msg').textContent = msg;
    }

    function isWall(x, y) {
      return map[y][x] === '#';
    }

    function movePlayer(dx, dy) {
      let newX = player.x + dx;
      let newY = player.y + dy;
      if (newX < 0 || newX >= 10 || newY < 0 || newY >= 10) return;
      if (isWall(newX, newY)) return;
      player.x = newX;
      player.y = newY;

      children.forEach(c => {
        if (!c.collected && c.x === player.x && c.y === player.y) {
          c.collected = true;
        }
      });

      draw();
      updateMsg();
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowUp') movePlayer(0, -1);
      if (e.key === 'ArrowDown') movePlayer(0, 1);
      if (e.key === 'ArrowLeft') movePlayer(-1, 0);
      if (e.key === 'ArrowRight') movePlayer(1, 0);

      let allCollected = children.every(c => c.collected);
      if (e.key === 'Enter' && player.x === exit.x && player.y === exit.y && allCollected) {
        if (currentLevel + 1 < levels.length) {
          currentLevel++;
          loadLevel(currentLevel);
        } else {
          document.getElementById('msg').textContent = 'ðŸŽ‰ All levels complete. You set them free.';
        }
      }
    });

    loadLevel(currentLevel);
  </script>
</body>
</html>
